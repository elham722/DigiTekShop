{
  "DeviceLimits": {
    "MaxActiveDevicesPerUser": 5,
    "MaxTrustedDevicesPerUser": 3,
    "DeviceInactivityThreshold": "30.00:00:00",
    "MaxTrustAttempts": 3,
    "DeviceTokenExpiration": "90.00:00:00",
    "AutoDeactivateInactiveDevices": true,
    "DefaultTrustNewDevices": false
  },

  "ConnectionStrings": {
    "Redis": "192.168.80.101:6379,password=Strong#Redis_Pass123!,abortConnect=false,ssl=false,defaultDatabase=0"
  },
  "RedisCache": {
    "InstanceName": "digitek:"
  },

  "JwtSettings": {
    "Issuer": "DigiTekShop",
    "Audience": "DigiTekShopClient",
    "AccessTokenExpirationMinutes": 60,
    "RefreshTokenExpirationDays": 30
  },

  "PasswordPolicy": {
    "MinLength": 12,
    "RequiredCategoryCount": 3,
    "MaxRepeatedChar": 3,
    "HistoryDepth": 5,
    "ForbidUserNameFragments": true,
    "ForbidEmailLocalPart": true,
    "Blacklist": [
      "password",
      "123456",
      "qwerty",
      "admin",
      "welcome",
      "iloveyou",
      "letmein",
      "abc123",
      "111111",
      "123123",
      "qwertyui",
      "654321",
      "hello123",
      "monkey123",
      "dragon123",
      "master",
      "696969",
      "mustang",
      "shadow",
      "ashley",
      "pokemon",
      "superman",
      "killer",
      "trustno1"
    ]
  },

  "EmailConfirmation": {
    "BaseUrl": "https://localhost:7055",
    "ConfirmEmailPath": "account/confirm-email",
    "TokenValidity": "24:00:00",
    "RequireEmailConfirmation": true,
    "AllowResendConfirmation": true,
    "ResendCooldown": "00:05:00",
    "Template": {
      "CompanyName": "DigiTekShop",
      "SupportEmail": "support@digitekshop.com",
      "LogoUrl": "",
      "PrimaryColor": "#007bff",
      "ContactUrl": ""
    }
  },

  "PhoneVerification": {
    "CodeLength": 6,
    "CodeValidity": "00:05:00",
    "MaxAttempts": 5,
    "RequirePhoneConfirmation": true,
    "AllowResendCode": true,
    "ResendCooldown": "00:02:00",
    "Security": {
      "AllowedPhonePattern": "^\\+98[0-9]{10}$",
      "MaxRequestsPerHour": 5,
      "MaxRequestsPerDay": 20,
      "MaxRequestsPerMonth": 100,
      "RequireUniquePhoneNumbers": true,
      "CountryCode": "+98",
      "IpRestrictionEnabled": false,
      "MaxRequestsPerIpPerHour": 10
    },
    "Template": {
      "CompanyName": "DigiTekShop",
      "SupportPhoneNumber": "",
      "WebsiteUrl": "https://digitekshop.com",
      "CodeTemplate": "{1} - کد تأیید شما: {0}",
      "CodeTemplateEnglish": "{1} - Your verification code: {0}",
      "UseEnglishTemplate": false,
      "MaxSmsLength": 160,
      "SenderNumber": ""
    }
  },

  "Email": {
    "Enabled": true,
    "Provider": "Smtp"
  },
  "SmtpSettings": {
    "Host": "smtp.gmail.com",
    "Port": 587,
    "Username": "",
    "Password": "",
    "EnableSsl": true,
    "UseDefaultCredentials": false,
    "TimeoutMs": 10000,
    "FromEmail": "",
    "FromName": "DigiTekShop",
    "ReplyToEmail": "",

    "MaxRetryAttempts": 3,
    "RetryDelayMs": 1000
  },

  "Sms": {
    "Enabled": true,
    "Provider": "Kavenegar"
  },
  "Kavenegar": {
    "ApiKey": "",
    "BaseUrl": "https://api.kavenegar.com/v1",
    "DefaultSender": "2000660110",
    "OtpTemplate": "login-otp",
    "TimeoutSeconds": 10
  },

  "PasswordReset": {
    "BaseUrl": "https://localhost:7000",
    "ResetPasswordPath": "auth/reset-password",
    "TokenValidityMinutes": 60,
    "IsEnabled": true,
    "AllowMultipleRequests": true,
    "RequestCooldownMinutes": 5,
    "MaxRequestsPerDay": 5,
    "Template": {
      "CompanyName": "DigiTekShop",
      "SupportEmail": "support@digitekshop.com",
      "LogoUrl": "",
      "PrimaryColor": "#007bff",
      "ContactUrl": "https://digitekshop.com/contact",
      "WebUrl": "https://digitekshop.com"
    }
  },

  "Security": {
    "NoStore": {
      "Pattern": "^/api/v\\d+/(auth|registration|password|twofactor|token|logout)/"
    },
    "BruteForce": {
      "Enabled": true,
      "MaxFailedAttempts": 5,
      "TimeWindow": "00:15:00",
      "LockoutDuration": "00:30:00",
      "IpBasedLockout": true,
      "DeviceBasedLockout": true,
      "MaxFailedAttemptsPerIp": 10,
      "MaxFailedAttemptsPerDevice": 8
    },
    "StepUp": {
      "Enabled": true,
      "RequiredForNewDevices": true,
      "RequiredForSensitiveOperations": true,
      "StepUpValidityDuration": "01:00:00",
      "MaxStepUpAttempts": 3,
      "StepUpLockoutDuration": "00:15:00"
    },
    "TokenSecurity": {
      "TokenReplayDetectionEnabled": true,
      "TokenRotationSecurityEnabled": true,
      "MaxActiveTokensPerUser": 5,
      "MaxActiveTokensPerDevice": 1
    }
  },

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },

  "Serilog": {
    "Using": [ "Serilog.Sinks.Console" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [ { "Name": "Console" } ],
    "Enrich": [ "FromLogContext" ],
    "Properties": { "Application": "DigiTekShop.API" }
  },

  "AllowedHosts": "*",
  "ReverseProxy": {
    "EnableForwardedHeaders": true,
    "TrustAll": false,
    "KnownProxies": [ "10.0.0.10" ],
    "KnownNetworks": [
      {
        "Prefix": "10.0.0.0",
        "PrefixLength": 24
      }
    ],
    "ForwardLimit": 1
  },

  "ApiKey": {
    "Enabled": false,
    "HeaderName": "X-API-Key",
    "ValidKeys": []
  },
  "Idempotency": {
    "TtlHours": 24,
    "MaxBodySizeBytes": 262144,
    "AllowedHeaderNames": [ "Location", "ETag", "Cache-Control", "Content-Language" ]
  },

  "ApiOptions": {
    "Version": "1.0",
    "Title": "DigiTekShop API",
    "Description": "DigiTekShop E-commerce API",
    "ContactName": "DigiTekShop Support",
    "ContactEmail": "support@digitekshop.com",
    "ContactUrl": "https://digitekshop.com/contact"
  }

}
