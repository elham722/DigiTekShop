{
  "DeviceLimits": {
    "MaxActiveDevicesPerUser": 5,
    "MaxTrustedDevicesPerUser": 3,
    "DeviceInactivityThreshold": "30.00:00:00",
    "MaxTrustAttempts": 3,
    "DeviceTokenExpiration": "90.00:00:00",
    "AutoDeactivateInactiveDevices": true,
    "DefaultTrustNewDevices": false
  },

  "ConnectionStrings": {
    "Redis": "192.168.80.101:6379,password=Strong#Redis_Pass123!,abortConnect=false,ssl=false,defaultDatabase=0"
  },

  "RedisCache": {
    "InstanceName": "digitek:"
  },

  "JwtSettings": {
    "Issuer": "DigiTekShop",
    "Audience": "DigiTekShopClient",
    "AccessTokenExpirationMinutes": 60,
    "RefreshTokenExpirationDays": 30
  },

 
  "EmailConfirmation": {
    "BaseUrl": "https://localhost:7055",
    "ConfirmEmailPath": "api/v1/account/confirm-email",
    "TokenValidity": "24:00:00",
    "RequireEmailConfirmation": true,
    "AllowResendConfirmation": true,
    "ResendCooldown": "00:05:00",
    "Template": {
      "CompanyName": "DigiTekShop",
      "SupportEmail": "support@digitekshop.com",
      "LogoUrl": "",
      "PrimaryColor": "#007bff",
      "ContactUrl": ""
    }
  },

  "PhoneVerification": {
    "CodeLength": 6,
    "CodeValidity": "00:05:00",
    "MaxAttempts": 5,
    "RequirePhoneConfirmation": true,
    "AllowResendCode": true,
    "ResendCooldown": "00:02:00",
    "Security": {
      "AllowedPhonePattern": "^\\+98[0-9]{10}$",
      "MaxRequestsPerHour": 5,
      "MaxRequestsPerDay": 20,
      "MaxRequestsPerMonth": 100,
      "RequireUniquePhoneNumbers": true,
      "CountryCode": "+98",
      "IpRestrictionEnabled": false,
      "MaxRequestsPerIpPerHour": 10
    },
    "Template": {
      "CompanyName": "DigiTekShop",
      "SupportPhoneNumber": "",
      "WebsiteUrl": "https://digitekshop.com",
      "CodeTemplate": "{1} - کد تأیید شما: {0}",
      "CodeTemplateEnglish": "{1} - Your verification code: {0}",
      "UseEnglishTemplate": false,
      "MaxSmsLength": 160,
      "SenderNumber": ""
    }
  },

  "Email": {
    "Enabled": true,
    "Provider": "Smtp"
  },
  "SmtpSettings": {
    "Host": "smtp.gmail.com",
    "Port": 587,
    "Username": "",
    "Password": "",
    "EnableSsl": true,
    "UseDefaultCredentials": false,
    "TimeoutMs": 10000,
    "FromEmail": "",
    "FromName": "DigiTekShop",
    "ReplyToEmail": "",

    "MaxRetryAttempts": 3,
    "RetryDelayMs": 1000
  },

  "Sms": {
    "Enabled": true,
    "Provider": "Kavenegar"
  },
  "Kavenegar": {
    "ApiKey": "",
    "BaseUrl": "https://api.kavenegar.com/v1",
    "DefaultSender": "2000660110",
    "OtpTemplate": "login-otp",
    "TimeoutSeconds": 10
  },

 
  "Security": {
    "NoStore": {
      "Pattern": "^/api/v\\d+/(auth|registration|password|twofactor|token|logout)/"
    },
    "BruteForce": {
      "Enabled": true,
      "MaxFailedAttempts": 5,
      "TimeWindow": "00:15:00",
      "LockoutDuration": "00:30:00",
      "IpBasedLockout": true,
      "DeviceBasedLockout": true,
      "MaxFailedAttemptsPerIp": 10,
      "MaxFailedAttemptsPerDevice": 8
    },
    "StepUp": {
      "Enabled": true,
      "RequiredForNewDevices": true,
      "RequiredForSensitiveOperations": true,
      "StepUpValidityDuration": "01:00:00",
      "MaxStepUpAttempts": 3,
      "StepUpLockoutDuration": "00:15:00"
    },
    "TokenSecurity": {
      "TokenReplayDetectionEnabled": true,
      "TokenRotationSecurityEnabled": true,
      "MaxActiveTokensPerUser": 5,
      "MaxActiveTokensPerDevice": 1
    }
  },

  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning"
    }
  },

  "Serilog": {
    "Using": [ "Serilog.Sinks.Console" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [ { "Name": "Console" } ],
    "Enrich": [ "FromLogContext" ],
    "Properties": { "Application": "DigiTekShop.API" }
  },

  "AllowedHosts": "*",
  "ReverseProxy": {
    "EnableForwardedHeaders": true,
    "TrustAll": false,
    "KnownProxies": [ "10.0.0.10" ],
    "KnownNetworks": [
      {
        "Prefix": "10.0.0.0",
        "PrefixLength": 24
      }
    ],
    "ForwardLimit": 1
  },

  "ApiKey": {
    "Enabled": false,
    "HeaderName": "X-API-Key",
    "ValidKeys": []
  },
  "Idempotency": {
    "TtlHours": 24,
    "MaxBodySizeBytes": 262144,
    "AllowedHeaderNames": [ "Location", "ETag", "Cache-Control", "Content-Language" ]
  },

  "Api": {
    "Metadata": {
      "Title": "DigiTekShop API",
      "Version": "v1",
      "Description": "..."
    },
    "Behavior": {
      "MaxPageSize": 100,
      "DefaultPageSize": 10
    }
  },


  "RabbitMq": {
    "HostName": "192.168.80.101",
    "Port": 5672,
    "VirtualHost": "/",
    "UserName": "digitek",
    "Password": "digitek",
    "Exchange": "digitekshop.exchange",
    "ExchangeType": "topic",
    "Durable": true
  },

  "FeatureFlags": {
    "Notifications": {
      "EnableEmailOnRegistration": true,
      "EnableSmsOnRegistration": true
    }
  },

  "Auth": {

    "LoginFlow": {
      "EnableMfa": false,
      "MfaChallengeTtlSeconds": 120,
      "TrustDeviceDays": 30,
      "RateLimit": {
        "Limit": 8,
        "WindowSeconds": 60
      }
    },
    "LoginAttempts": {
      "MaxListLimit": 200,
      "MaskSensitiveInLogs": true,
      "IpMaskReplacement": "*"
    }
  },

  "Identity": {
    "Lockout": {
      "DefaultDurationMinutes": 15,
      "MaxDurationDays": 7,
      "AllowManualUnlock": true
    }
  },

  "SecurityEvents": {
    "MaxListLimit": 200,
    "TopIpCount": 10,
    "MaxMetadataLength": 8192,
    "MaxUserAgentLength": 1024,
    "MaxDeviceIdLength": 128,
    "MaxIpLength": 64,
    "DefaultSeverityMappings": {
      "FailedLogin": "Medium",
      "MfaFailed": "High",
      "PasswordChanged": "Low",
      "RefreshTokenAbuse": "High"
    }
  }
}
